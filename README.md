# Neev-Penkar-Encryption-Suite
The Neev Penkar Encryption Suite is a group of cryptographic functions in Python 3, designed originally for password-protecting email data.
**An Important Note: This code still has a lot of work to go through, it still hasn't been reviewed by security experts, and is more of a proof of concept than anything else. Password protection is not ideal on its known in today's world, as computers are fast and the entropy of passwords is going down as more and more passwords are being leaked, cracked and stored. The ideal solution would be to enforce this encryption with a hybrid encryption scheme, making use of personal identification certificates and public-key cryptography.**

As part of introducing **End-To-End** encryption for simple emails, a buffer between the user and the mail service was needed. The raw API used the Python email.MIME package for the formation of the email, and the actual encryption was performed by this tool, which accepts a user's password and the data, both in binary form which allow flexibility for messages as well as attachments.

The process starts by producing an HMAC of the key with a randomly generated salt, multiple thousand times, and by encryption of this HMAC with a stream cipher by the password. This process is considered not useful, but is very fast on modern CPU's and is an example of the encrypted salt method. It balances the time it takes for the KDF to generate the encrypting key in the next step. The user password is then passed on to the SCrypt KDF with the encrypted salt, after which the data is padded and encrypted (AES-128_CBC) and a HMAC is generated for authentication of ciphertext. The nonce for the stream, iv, HMAC, salt and the ciphertext is appended to a dictionary. The final step is to pad the respective fields with opening and closing tags as the transfer of data through SMTP servers may introduce extra, unwanted spaces which may certainly mess with the authentication and/or decryption.

At the receiving end, the email is parsed through the Neev Penkar Decryption Suite, which follows almost all of the steps mentioned above, but checks the authenticity of the data received, before decrypting and returning the data.
